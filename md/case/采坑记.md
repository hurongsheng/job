### redis 连接池不够用

#### 事故发生背景

    微服务接入sidecar，sidecar要求单机部署
    所以没台物理机混布改成了，单机只部署一个服务，单机部署后机器总数下降
    其中单机redis cli设置了连接池30，高并发时连接池竞争导致gorotine积压服务器雪崩
    
#### 事中处理

    重启问题机子，先增加服务器，后续增加连接池
 
#### 事后预防

    1.增加连接池
    2.灾难自启动策略（拟）
    
    
### mongo不可用

#### 事故发生背景

    本以为的独享mongo被B端服务混用
    b端批量任务打爆mongo导致服务不可用
    
#### 事中处理

    服务不可用后，b端停止请求，但mongo任未恢复
    未恢复是由于c端写请求在故障期间积压，虽然此时b端请求停止，但是c端积压了请求
    在mongo高负载的情况下持续请求导致未恢复
    
    临时熔断请求，重启服务，服务恢复
    
#### 事后预防

    1.请求增加更加严格的超时时间
    2.增加熔断机制
    3.写操作改异步
   